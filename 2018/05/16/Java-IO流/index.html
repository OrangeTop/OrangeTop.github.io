<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<style>
    .pace .pace-progress {
        background: #1E92FB; /*进度条颜色*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #1E92FB, 0 0 5px     #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #1E92FB;    /*上边框颜色*/
        border-left-color: #1E92FB;    /*左边框颜色*/
    }
</style>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Java,JavaSE," />










<meta name="description" content="输入流和输出流相对于内存设备而言. 将外设中的数据读取到内存中：输入 将内存的数写入到外设中：输出 字节流的两个顶层父类： InputStream   OutputStream.   字符流的两个顶层父类： Reader  Writer   这些体系的子类都以父类名作为后缀。  而且子类名的前缀就是该对象的功能。  字符流 字符流的由来： 其实就是：字节流读取文字字节数据后，不直接操作而是先查指">
<meta name="keywords" content="Java,JavaSE">
<meta property="og:type" content="article">
<meta property="og:title" content="Java-IO流">
<meta property="og:url" content="http://yoursite.com/2018/05/16/Java-IO流/index.html">
<meta property="og:site_name" content="Orange&#39;s Blog">
<meta property="og:description" content="输入流和输出流相对于内存设备而言. 将外设中的数据读取到内存中：输入 将内存的数写入到外设中：输出 字节流的两个顶层父类： InputStream   OutputStream.   字符流的两个顶层父类： Reader  Writer   这些体系的子类都以父类名作为后缀。  而且子类名的前缀就是该对象的功能。  字符流 字符流的由来： 其实就是：字节流读取文字字节数据后，不直接操作而是先查指">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://raw.githubusercontent.com/OrangeTop/BlogImage/master/oldImage/%E5%A4%8D%E5%88%B6%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6%E5%9B%BE%E8%A7%A3.bmp">
<meta property="og:image" content="https://raw.githubusercontent.com/OrangeTop/BlogImage/master/oldImage/readLine%E6%96%B9%E6%B3%95%E5%8E%9F%E7%90%86.bmp">
<meta property="og:image" content="https://raw.githubusercontent.com/OrangeTop/BlogImage/master/oldImage/%E8%BD%AC%E6%8D%A2%E6%B5%81%E6%A1%A5%E6%A2%81.bmp">
<meta property="og:image" content="https://raw.githubusercontent.com/OrangeTop/BlogImage/master/oldImage/TIM%E5%9B%BE%E7%89%8720180525165910.png">
<meta property="og:updated_time" content="2018-11-09T05:56:21.266Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Java-IO流">
<meta name="twitter:description" content="输入流和输出流相对于内存设备而言. 将外设中的数据读取到内存中：输入 将内存的数写入到外设中：输出 字节流的两个顶层父类： InputStream   OutputStream.   字符流的两个顶层父类： Reader  Writer   这些体系的子类都以父类名作为后缀。  而且子类名的前缀就是该对象的功能。  字符流 字符流的由来： 其实就是：字节流读取文字字节数据后，不直接操作而是先查指">
<meta name="twitter:image" content="https://raw.githubusercontent.com/OrangeTop/BlogImage/master/oldImage/%E5%A4%8D%E5%88%B6%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6%E5%9B%BE%E8%A7%A3.bmp">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/05/16/Java-IO流/"/>





  <title>Java-IO流 | Orange's Blog</title>
  <!-- 背景动画 -->
  <script type="text/javascript" src="/js/src/particle.js"></script>
  








  <!-- 页面点击小红心 -->
  <script type="text/javascript" src="/js/src/love.js"></script>
  <!-- 背景动画 -->
  <script type="text/javascript" src="/js/src/particle.js"></script>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Orange's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/16/Java-IO流/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Orange">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Orange's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Java-IO流</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-16T19:53:53+08:00">
                2018-05-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaSE/" itemprop="url" rel="index">
                    <span itemprop="name">JavaSE</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/05/16/Java-IO流/" class="leancloud_visitors" data-flag-title="Java-IO流">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <ul>
<li>输入流和输出流相对于内存设备而言.</li>
<li>将外设中的数据读取到内存中：输入</li>
<li>将内存的数写入到外设中：输出</li>
<li>字节流的两个顶层父类：<ul>
<li>InputStream  </li>
<li>OutputStream.</li>
</ul>
</li>
<li>字符流的两个顶层父类：<ul>
<li>Reader </li>
<li>Writer</li>
</ul>
</li>
<li>这些体系的子类都以父类名作为后缀。 </li>
<li>而且子类名的前缀就是该对象的功能。</li>
</ul>
<h2 id="字符流"><a href="#字符流" class="headerlink" title="字符流"></a>字符流</h2><ul>
<li>字符流的由来：</li>
<li>其实就是：字节流读取文字字节数据后，不直接操作而是先查指定的编码表。获取对应的文字。</li>
<li>在对这个文字进行操作。简单说：字节流+编码表 </li>
</ul>
<h3 id="FileWriter"><a href="#FileWriter" class="headerlink" title="FileWriter"></a>FileWriter</h3><h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><ul>
<li>需求：将一些文字存储到硬盘一个文件中。流程在代码注释中。</li>
</ul>
<ul>
<li>创建一个可以往文件中写入字符数据的字符输出流对象，如第14行代码</li>
<li>既然是往一个文件中写入文字数据，那么在创建对象时，就必须明确该文件(用于存储数据的目的地)。<ul>
<li>如果文件不存在，则会自动创建；如果文件存在，则会被覆盖。</li>
</ul>
</li>
<li>为什么调用Writer对象中的write(string)方法，写入数据后，文件并没有显示写入的数据？<ul>
<li>其实数据只是写入到临时存储缓冲区中，还需要进行刷新 flush();</li>
</ul>
</li>
<li>close();关闭流，关闭资源。在关闭前会先调用flush刷新缓冲中的数据到目的地。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileWriterDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//换行，unix windows 不一样 ,所以使用这个</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String LINE_SEPARATOR = System.getProperty(<span class="string">"line.separator"</span>);</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//创建一个可以往文件中写入字符数据的字符输出流对象。</span></span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">		 * 如果构造函数中加入true，可以实现对文件进行续写！</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		FileWriter fw = <span class="keyword">new</span> FileWriter(<span class="string">"demo.txt"</span>,<span class="keyword">true</span>);</span><br><span class="line">		</span><br><span class="line">         <span class="comment">//调用Writer对象中的write(string)方法，写入数据</span></span><br><span class="line">		fw.write(<span class="string">"abcde"</span>+LINE_SEPARATOR+<span class="string">"hahaha"</span>);</span><br><span class="line">		<span class="comment">//fw.write("xixi");</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//进行刷新，将数据直接写到目的地中。</span></span><br><span class="line">		fw.flush();</span><br><span class="line">        </span><br><span class="line">		<span class="comment">// 关闭流，关闭资源。在关闭前会先调用flush刷新缓冲中的数据到目的地。</span></span><br><span class="line">		fw.close();</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//关闭流后，无法再进行写操作</span></span><br><span class="line"><span class="comment">//		fw.write("haha");// java.io.IOException: Stream closed</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="处理异常"><a href="#处理异常" class="headerlink" title="处理异常"></a>处理异常</h4><ul>
<li>最好使用try，catch。在外部初始化创建 fileWriter，new在try代码块内部</li>
<li>finally中判断是否为空，然后写关闭的语句，给它也进行try，catch</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IOExceptionDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		FileWriter fw = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">			fw = <span class="keyword">new</span> FileWriter(<span class="string">"k:\\demo.txt"</span>);</span><br><span class="line"></span><br><span class="line">			fw.write(<span class="string">"abcde"</span> + LINE_SEPARATOR + <span class="string">"hahaha"</span>);</span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			System.out.println(e.toString());</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (fw != <span class="keyword">null</span>)</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					fw.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					<span class="comment">// code....	</span></span><br><span class="line">					<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"关闭失败"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="FileReader"><a href="#FileReader" class="headerlink" title="FileReader"></a>FileReader</h3><ul>
<li>需求：读取一个文本文件。将读取到的字符打印到控制台</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">FileReader fr = <span class="keyword">new</span> FileReader(<span class="string">"demo.txt"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ch = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>((ch=fr.read())!=-<span class="number">1</span>)&#123;</span><br><span class="line">	System.out.println((<span class="keyword">char</span>)ch);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//如果读完已有值后，再读取文件，会返回-1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>第二种读取方式：<ul>
<li>以数组为单位的读取</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">假设demo.txt中有 abcde 五个字母</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span>[] buf = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">3</span>];</span><br><span class="line"><span class="comment">//将读取到的字符存储到数组中</span></span><br><span class="line"><span class="keyword">int</span> num = fr.read(buf);</span><br><span class="line">System.out.println(num+<span class="string">":"</span>+<span class="keyword">new</span> String(buf));	<span class="comment">//abc</span></span><br><span class="line"><span class="keyword">int</span> num1 = fr.read(buf);</span><br><span class="line">System.out.println(num1+<span class="string">":"</span>+<span class="keyword">new</span> String(buf));	<span class="comment">//dec</span></span><br></pre></td></tr></table></figure>
<ul>
<li>为什么一共只有五个字母，第二次读取时却是 ”dec“ ？<ul>
<li>因为是存在缓冲区，第一次abc没有清除，第二次是de覆盖了ab</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">FileReader fr = <span class="keyword">new</span> FileReader(<span class="string">"demo.txt"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span>[] buf = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">1024</span>];</span><br><span class="line"><span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>((len=fr.read(buf))!=-<span class="number">1</span>)&#123;</span><br><span class="line">	System.out.println(<span class="keyword">new</span> String(buf,<span class="number">0</span>,len));<span class="comment">//读取buf，从0读到len</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="练习：复制文件"><a href="#练习：复制文件" class="headerlink" title="练习：复制文件"></a>练习：复制文件</h4><ul>
<li>练习：将c盘的一个文本文件复制到d盘</li>
</ul>
<p><img src="https://raw.githubusercontent.com/OrangeTop/BlogImage/master/oldImage/%E5%A4%8D%E5%88%B6%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6%E5%9B%BE%E8%A7%A3.bmp" alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CopyTextTest_2</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> BUFFER_SIZE = <span class="number">1024</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//读取一个已有的文本文件，使用字符读取流和文件相关联。</span></span><br><span class="line">		FileReader fr = <span class="keyword">null</span>;</span><br><span class="line">		<span class="comment">//创建一个目的，用于存储读到数据。</span></span><br><span class="line">		FileWriter fw = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			fr = <span class="keyword">new</span> FileReader(<span class="string">"IO流_2.txt"</span>);</span><br><span class="line">			fw = <span class="keyword">new</span> FileWriter(<span class="string">"copytest_2.txt"</span>);</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//创建一个临时容器，用于缓存读取到的字符。</span></span><br><span class="line">			<span class="keyword">char</span>[] buf = <span class="keyword">new</span> <span class="keyword">char</span>[BUFFER_SIZE];<span class="comment">//这就是缓冲区。 </span></span><br><span class="line">			</span><br><span class="line">			<span class="comment">//定义一个变量记录读取到的字符数，(其实就是往数组里装的字符个数 )</span></span><br><span class="line">			<span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">while</span>((len=fr.read(buf))!=-<span class="number">1</span>)&#123;</span><br><span class="line">				fw.write(buf, <span class="number">0</span>, len);	<span class="comment">//读取buf，从0开始，len结束</span></span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"读写失败"</span>);</span><br><span class="line">		&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(fw!=<span class="keyword">null</span>)</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					fw.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			<span class="keyword">if</span>(fr!=<span class="keyword">null</span>)</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					fr.close();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="缓冲区"><a href="#缓冲区" class="headerlink" title="缓冲区"></a>缓冲区</h3><ul>
<li>这就好比去超市，没有缓冲区就是买一样东西一结帐，有缓冲区就是拿着筐或者推着车，买完再结帐，可以大幅度提高效率</li>
<li>不过如果车过大会堵塞出口，那样的话就可以在车子里面放几个筐，结账用筐，也会提高效率</li>
</ul>
<h4 id="BufferWriter"><a href="#BufferWriter" class="headerlink" title="BufferWriter"></a>BufferWriter</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">		FileWriter fw = <span class="keyword">new</span> FileWriter(<span class="string">"buf.txt"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//为了提高写入的效率。使用了字符流的缓冲区。</span></span><br><span class="line">		<span class="comment">//创建了一个字符写入流的缓冲区对象，并和指定要被缓冲的流对象相关联</span></span><br><span class="line">		BufferedWriter bufw = <span class="keyword">new</span> BufferedWriter(fw);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//使用缓冲区的写入方法将数据先写入到缓冲区中。</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> x=<span class="number">1</span>; x&lt;=<span class="number">4</span>; x++)&#123;</span><br><span class="line">			bufw.write(<span class="string">"abcdef"</span>+x);</span><br><span class="line">			bufw.newLine();</span><br><span class="line">			<span class="comment">//使用缓冲区的刷新方法将数据刷目的地中。</span></span><br><span class="line">			bufw.flush();</span><br><span class="line">		&#125;</span><br><span class="line">				</span><br><span class="line">		<span class="comment">//关闭缓冲区。其实关闭的就是被缓冲的流对象。</span></span><br><span class="line">		bufw.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="BufferReader"><a href="#BufferReader" class="headerlink" title="BufferReader"></a>BufferReader</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">FileReader fr = <span class="keyword">new</span> FileReader(<span class="string">"buf.txt"</span>);		</span><br><span class="line">BufferedReader bufr = <span class="keyword">new</span> BufferedReader(fr);</span><br><span class="line"></span><br><span class="line">FileWriter fw = <span class="keyword">new</span> FileWriter(<span class="string">"buf_copy.txt"</span>);</span><br><span class="line">BufferedWriter bufw = <span class="keyword">new</span> BufferedWriter(fw);</span><br><span class="line"></span><br><span class="line">String line = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>((line=bufr.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line">	bufw.write(line);</span><br><span class="line">    bufw.newLine();</span><br><span class="line">    bufw.flush();</span><br><span class="line">&#125;	</span><br><span class="line">bufw.close();</span><br><span class="line">bufr.close();</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/OrangeTop/BlogImage/master/oldImage/readLine%E6%96%B9%E6%B3%95%E5%8E%9F%E7%90%86.bmp" alt=""></p>
<h4 id="自定义MyBufferReader"><a href="#自定义MyBufferReader" class="headerlink" title="自定义MyBufferReader"></a>自定义MyBufferReader</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自定义的读取缓冲区。其实就是模拟一个BufferedReader.</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * 分析：</span></span><br><span class="line"><span class="comment"> * 缓冲区中无非就是封装了一个数组，</span></span><br><span class="line"><span class="comment"> * 并对外提供了更多的方法对数组进行访问。</span></span><br><span class="line"><span class="comment"> * 其实这些方法最终操作的都是数组的角标。</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * 缓冲的原理：</span></span><br><span class="line"><span class="comment"> * 其实就是从源中获取一批数据装进缓冲区中。</span></span><br><span class="line"><span class="comment"> * 在从缓冲区中不断的取出一个一个数据。</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * 在此次取完后，在从源中继续取一批数据进缓冲区。</span></span><br><span class="line"><span class="comment"> * 当源中的数据取光时，用-1作为结束标记。 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBufferedReader</span> <span class="keyword">extends</span> <span class="title">Reader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Reader r;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//定义一个数组作为缓冲区。</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">char</span>[] buf = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">1024</span>];</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//定义一个指针用于操作这个数组中的元素。当操作到最后一个元素后，指针应该归零。	</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> pos = <span class="number">0</span>;	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//定义一个计数器用于记录缓冲区中的数据个数。 当该数据减到0，就从源中继续获取数据到缓冲区中。</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	MyBufferedReader(Reader r)&#123;</span><br><span class="line">		<span class="keyword">this</span>.r = r;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 该方法从缓冲区中一次取一个字符。 </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">myRead</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(count==<span class="number">0</span>)&#123;</span><br><span class="line">			count = r.read(buf);</span><br><span class="line">			pos = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(count&lt;<span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">char</span> ch = buf[pos++];</span><br><span class="line">		</span><br><span class="line">		count--;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> ch;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">myReadLine</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">		</span><br><span class="line">		StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> ch = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>((ch = myRead())!=-<span class="number">1</span>)&#123;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">if</span>(ch==<span class="string">'\r'</span>)</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span>(ch==<span class="string">'\n'</span>)</span><br><span class="line">				<span class="keyword">return</span> sb.toString();</span><br><span class="line">			<span class="comment">//将从缓冲区中读到的字符，存储到缓存行数据的缓冲区中。</span></span><br><span class="line">			sb.append((<span class="keyword">char</span>)ch);</span><br><span class="line">			</span><br><span class="line">		&#125;		</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(sb.length()!=<span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span> sb.toString();</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">myClose</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		r.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="装饰设计模式"><a href="#装饰设计模式" class="headerlink" title="装饰设计模式"></a>装饰设计模式</h4><ul>
<li>对一组对象的功能进行增强时，就可以使用该模式进行问题的解决。</li>
<li>缓冲区的设计就是基于装饰设计模式实现的</li>
<li>然而装饰和继承都能实现一样的特点：进行功能的扩展增强。哪个好那？</li>
</ul>
<h5 id="装饰和继承对比"><a href="#装饰和继承对比" class="headerlink" title="装饰和继承对比"></a>装饰和继承对比</h5><ul>
<li>假设有一个继承体系</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Writer</span><br><span class="line">	|--TextWriter：用于操作文本</span><br><span class="line">	|--MediaWriter：用于操作媒体。</span><br></pre></td></tr></table></figure>
<ul>
<li>想要对操作的动作进行效率的提高，需要加入缓冲技术。</li>
<li>按照面向对象，可以通过继承对具体的进行功能的扩展。 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Writer</span><br><span class="line">	|--TextWriter：用于操作文本</span><br><span class="line">		|--BufferTextWriter：加入了缓冲技术的操作文本的对象。</span><br><span class="line">	|--MediaWriter：用于操作媒体。</span><br><span class="line">		|--BufferMediaWriter:</span><br><span class="line">但是这样做好像并不理想，如果这个体系进行功能扩展，又多了流对象。</span><br><span class="line">那么这个流要提高效率，是不是也要产生子类呢？</span><br><span class="line">是。这时就会发现只为提高功能，进行的继承，导致继承体系越来越臃肿。不够灵活。</span><br></pre></td></tr></table></figure>
<ul>
<li>既然加入的都是同一种技术–缓冲。前一种是让缓冲和具体的对象相结合。 </li>
<li>可不可以将缓冲进行单独的封装，哪个对象需要缓冲就将哪个对象和缓冲关联。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Writer</span><br><span class="line">	|--TextWriter：用于操作文本</span><br><span class="line">	|--MediaWriter：用于操作媒体。</span><br><span class="line">	|--BufferWriter：用于提高效率。</span><br><span class="line">	</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BufferWriter</span> <span class="keyword">extends</span> <span class="title">Writer</span></span>&#123;</span><br><span class="line">	BufferWriter(Writer w)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>装饰比继承灵活</strong></li>
<li>特点：装饰类和被装饰类都必须所属同一个接口或者父类。 </li>
</ul>
<h4 id="LineNumberReader"><a href="#LineNumberReader" class="headerlink" title="LineNumberReader"></a>LineNumberReader</h4><ul>
<li>可以增添行号</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">    FileReader fr = <span class="keyword">new</span> FileReader(<span class="string">"IO流_2.txt"</span>);</span><br><span class="line">    LineNumberReader lnr = <span class="keyword">new</span> LineNumberReader(fr);</span><br><span class="line"></span><br><span class="line">    String line = <span class="keyword">null</span>;</span><br><span class="line">    lnr.setLineNumber(<span class="number">100</span>);</span><br><span class="line">    <span class="keyword">while</span>((line=lnr.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line">        System.out.println(lnr.getLineNumber()+<span class="string">":"</span>+line);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    lnr.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="字节流"><a href="#字节流" class="headerlink" title="字节流"></a>字节流</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">demo_read</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">    <span class="comment">//1，创建一个读取流对象。和指定文件关联。</span></span><br><span class="line">    FileInputStream fis = <span class="keyword">new</span> FileInputStream(<span class="string">"bytedemo.txt"</span>);</span><br><span class="line">   </span><br><span class="line">    <span class="comment">//建议使用这种读取数据的方式</span></span><br><span class="line">    <span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];		</span><br><span class="line">    <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>((len=fis.read(buf))!=-<span class="number">1</span>)&#123;</span><br><span class="line">        System.out.println(<span class="keyword">new</span> String(buf,<span class="number">0</span>,len));</span><br><span class="line">    &#125;		</span><br><span class="line">	fis.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">demo_write</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">    <span class="comment">//1，创建字节输出流对象。用于操作文件.</span></span><br><span class="line">    FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"bytedemo.txt"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2,写数据。直接写入到了目的地中。 </span></span><br><span class="line">    fos.write(<span class="string">"abcdefg"</span>.getBytes());</span><br><span class="line"></span><br><span class="line">    fos.close();<span class="comment">//关闭资源动作要完成。 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h3><ul>
<li>复制一个Mp3文件</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CopyMp3Test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> IOException </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">		copy_2();</span><br><span class="line">	</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//fis.available()：文件的字节数</span></span><br><span class="line">    <span class="comment">//如果文件字节数特别大，那么速度会很慢</span></span><br><span class="line">    <span class="comment">//不建议使用</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copy_3</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		FileInputStream fis = <span class="keyword">new</span> FileInputStream(<span class="string">"c:\\0.mp3"</span>);		</span><br><span class="line">		FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"c:\\3.mp3"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[fis.available()];</span><br><span class="line">		fis.read(buf);</span><br><span class="line">		fos.write(buf);</span><br><span class="line">		fos.close();</span><br><span class="line">		fis.close();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copy_2</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		FileInputStream fis = <span class="keyword">new</span> FileInputStream(<span class="string">"c:\\0.mp3"</span>);	</span><br><span class="line">		BufferedInputStream bufis = <span class="keyword">new</span> BufferedInputStream(fis);</span><br><span class="line">		</span><br><span class="line">		FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"c:\\2.mp3"</span>);</span><br><span class="line">		BufferedOutputStream bufos = <span class="keyword">new</span> BufferedOutputStream(fos);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> ch = <span class="number">0</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span>((ch=bufis.read())!=-<span class="number">1</span>)&#123;</span><br><span class="line">			bufos.write(ch);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		bufos.close();</span><br><span class="line">		bufis.close();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">copy_1</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		FileInputStream fis = <span class="keyword">new</span> FileInputStream(<span class="string">"c:\\0.mp3"</span>);		</span><br><span class="line">		FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"c:\\1.mp3"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span>((len=fis.read(buf))!=-<span class="number">1</span>)&#123;</span><br><span class="line">			fos.write(buf,<span class="number">0</span>,len);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		fos.close();</span><br><span class="line">		fis.close();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="键盘录入"><a href="#键盘录入" class="headerlink" title="键盘录入"></a>键盘录入</h3><ul>
<li>运行下面代码后，在控制台输入一个字母，按回车运行，是不是发现多出来一个 10 ？</li>
<li>是的，这个是“ \n ”,也就是刚才的回车。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readKey</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">	InputStream in = System.in;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> ch = in.read();<span class="comment">//阻塞式方法。		</span></span><br><span class="line">	System.out.println(ch);</span><br><span class="line">	<span class="keyword">int</span> ch1 = in.read();<span class="comment">//阻塞式方法。		</span></span><br><span class="line">	System.out.println(ch1);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="练习-1"><a href="#练习-1" class="headerlink" title="练习"></a>练习</h4><ul>
<li>获取用户键盘录入的数据，并将数据变成大写显示在控制台上</li>
<li>如果用户输入的是over，结束键盘录入。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readKey2</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//1，创建容器。</span></span><br><span class="line">	StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2，获取键盘读取流。		</span></span><br><span class="line">    InputStream in = System.in;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3，定义变量记录读取到的字节，并循环获取。 		</span></span><br><span class="line">    <span class="keyword">int</span> ch = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>((ch=in.read())!=-<span class="number">1</span>)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//在存储之前需要判断是否是换行标记 ,因为换行标记不存储。 </span></span><br><span class="line">        <span class="keyword">if</span>(ch==<span class="string">'\r'</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span>(ch==<span class="string">'\n'</span>)&#123;</span><br><span class="line">            String temp = sb.toString();</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">"over"</span>.equals(temp))</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        System.out.println(temp.toUpperCase());</span><br><span class="line">        sb.delete(<span class="number">0</span>, sb.length());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    	<span class="comment">//将读取到的字节存储到StringBuilder中。</span></span><br><span class="line">    	sb.append((<span class="keyword">char</span>)ch);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="转换流"><a href="#转换流" class="headerlink" title="转换流"></a>转换流</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 这是方便理解的做法</span></span><br><span class="line"><span class="comment">//字节流</span></span><br><span class="line"><span class="comment">InputStream in = System.in;</span></span><br><span class="line"><span class="comment">OutputStream out = System.out;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">//将字节转成字符的桥梁。装换流。 </span></span><br><span class="line"><span class="comment">InputStreamReader isr = new InputStreamReader(in);</span></span><br><span class="line"><span class="comment">OutputStreamWriter osw = new OutputStreamWriter(out);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">//字符流。</span></span><br><span class="line"><span class="comment">BufferedReader bufr = new BufferedReader(isr);</span></span><br><span class="line"><span class="comment">BufferedWriter  bufw = new BufferedWriter(osw);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//更简洁</span></span><br><span class="line">BufferReader bufr = <span class="keyword">new</span> BufferReader(<span class="keyword">new</span> InputStream(System.in));</span><br><span class="line">BufferWriter bufr = <span class="keyword">new</span> BufferWriter(<span class="keyword">new</span> OutputStream(System.out));</span><br><span class="line"></span><br><span class="line">String line = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>((line=bufr.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">"over"</span>.equals(line))</span><br><span class="line">        <span class="keyword">break</span>;			</span><br><span class="line">    bufw.write(line.toUpperCase());</span><br><span class="line">    bufw.newLine();</span><br><span class="line">    bufw.flush();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/OrangeTop/BlogImage/master/oldImage/%E8%BD%AC%E6%8D%A2%E6%B5%81%E6%A1%A5%E6%A2%81.bmp" alt=""></p>
<ul>
<li>1、需求：将键盘录入的数据写入到一个文件中。 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BufferedReader bufr = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in));</span><br><span class="line">BufferedWriter bufw = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(newFileOutputStream(<span class="string">"a.txt"</span>)));</span><br></pre></td></tr></table></figure>
<ul>
<li>2、需求：将一个文本文件内容显示在控制台上。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BufferedReader bufr = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(newFileInputStream(<span class="string">"a.txt"</span>)));</span><br><span class="line">BufferedWriter bufw = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(System.out));</span><br></pre></td></tr></table></figure>
<ul>
<li>3、需求：将一个文件文件中的内容复制到的另一个文件中。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BufferedReader bufr = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(newFileInputStream(<span class="string">"a.txt"</span>)));</span><br><span class="line">BufferedWriter bufw = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(newFileOutputStream(<span class="string">"b.txt"</span>)));</span><br></pre></td></tr></table></figure>
<ul>
<li>根据不同的需求，改变源的不同位置即可</li>
</ul>
<h3 id="编码解码"><a href="#编码解码" class="headerlink" title="编码解码"></a>编码解码</h3><ul>
<li>file 流中的read write都是默认编码，如果需要指定编码，则选择其父类</li>
<li>InputStreamReader 、OutputStreamWriter</li>
<li>OutputStreamWriter接收一个字节输出流对象，既然是操作文件，那么该对象应该是FileOutputStream</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">OutputStreamWriter osw = <span class="keyword">new</span> OutputStreamWriter(<span class="keyword">new</span> FileOutputStream(<span class="string">"uu.txt"</span>),<span class="string">"UTF-8"</span>);</span><br><span class="line"><span class="comment">//BufferedWriter bufw = new BufferedWriter(new OutputStreamWriter(new FileOutputStream("uu.txt"),"UTF-8"));</span></span><br><span class="line"></span><br><span class="line">osw.write(<span class="string">"你好"</span>);</span><br><span class="line">osw.close();</span><br></pre></td></tr></table></figure>
<ul>
<li>什么时候使用转换流呢？<ul>
<li>1、源或者目的对应的设备是字节流，但是操作的却是文本数据，可以使用转换作为桥梁。提高对文本操作的便捷。</li>
<li>2、一旦操作文本涉及到具体的指定编码表时，必须使用转换流 。</li>
</ul>
</li>
</ul>
<h2 id="流的操作规律"><a href="#流的操作规律" class="headerlink" title="流的操作规律"></a>流的操作规律</h2><ul>
<li>之所以要弄清楚这个规律，是因为流对象太多，开发时不知道用哪个对象合适。</li>
<li>想要知道开发时用到哪些对象。只要通过四个明确即可。</li>
<li>1、明确源和目的(汇)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">源：InputStream  Reader</span><br><span class="line">目的：OutputStream  Writer</span><br></pre></td></tr></table></figure>
<ul>
<li>2、明确数据是否是纯文本数据。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">源：是纯文本：	Reader</span><br><span class="line">	否：	InputStream</span><br><span class="line"></span><br><span class="line">目的：是纯文本： Writer</span><br><span class="line">	否：	OutputStream</span><br></pre></td></tr></table></figure>
<p>到这里，就可以明确需求中具体要使用哪个体系。</p>
<ul>
<li>3、明确具体的设备。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">源设备：	</span><br><span class="line">    硬盘：	File</span><br><span class="line">    键盘：	System.in</span><br><span class="line">    内存：	数组</span><br><span class="line">    网络：	Socket流</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">目的设备：</span><br><span class="line">	硬盘：	File</span><br><span class="line">	控制台：System.out</span><br><span class="line">	内存：	数组</span><br><span class="line">	网络：	Socket流</span><br></pre></td></tr></table></figure>
<ul>
<li>4、是否需要其他额外功能。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、是否需要高效(缓冲区);</span><br><span class="line">	是，就加上buffer.</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、转换。</span><br></pre></td></tr></table></figure>
<h2 id="File对象"><a href="#File对象" class="headerlink" title="File对象"></a>File对象</h2><ul>
<li>可以将一个已存在的，或者不存在的文件或者目录封装成file对象。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">File f1 = <span class="keyword">new</span> File(<span class="string">"c:\\a.txt"</span>);</span><br><span class="line">File f2 = <span class="keyword">new</span> File(<span class="string">"c:\\"</span>,<span class="string">"a.txt"</span>);</span><br><span class="line">File f = <span class="keyword">new</span> File(<span class="string">"c:\\"</span>);</span><br><span class="line">File f3 = <span class="keyword">new</span> File(f,<span class="string">"a.txt"</span>);</span><br><span class="line">File f4 = <span class="keyword">new</span> File(<span class="string">"c:"</span>+File.separator+<span class="string">"abc"</span>+File.separator+<span class="string">"a.txt"</span>);</span><br><span class="line">System.out.println(f4);</span><br></pre></td></tr></table></figure>
<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><ul>
<li>1、获取<ul>
<li>获取文件名称</li>
<li>1.2 获取文件路径</li>
<li>1.3 获取文件大小</li>
<li>1.4 获取文件修改时间</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">File file = <span class="keyword">new</span> File(<span class="string">"a.txt"</span>);</span><br><span class="line">String name = file.getName();</span><br><span class="line">String absPath = file.getAbsolutePath();<span class="comment">//绝对路径（开头有盘符）</span></span><br><span class="line">String path = file.getPath();	<span class="comment">//相对路径（开头无盘符）（找不到父目录）</span></span><br><span class="line"><span class="keyword">long</span> len = file.length();</span><br><span class="line"><span class="keyword">long</span> time = file.lastModified();	<span class="comment">//毫秒值</span></span><br><span class="line">Date date = <span class="keyword">new</span> Date(time);			</span><br><span class="line"><span class="comment">//Date对象格式化</span></span><br><span class="line">DateFormat dateFormat = DateFormat.getDateTimeInstance(DateFormat.LONG,DateFormat.LONG);</span><br><span class="line">String str_time = dateFormat.format(date);</span><br></pre></td></tr></table></figure>
<ul>
<li>2、创建与删除</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//和输出流不一样，如果文件不存在，则创建，如果文件存在，则不创建。 </span></span><br><span class="line"><span class="keyword">boolean</span> b = file.createNewFile();		</span><br><span class="line">System.out.println(<span class="string">"b="</span>+b);</span><br><span class="line"></span><br><span class="line"><span class="keyword">boolean</span> b = file.delete();</span><br><span class="line">System.out.println(<span class="string">"b="</span>+b);</span><br><span class="line"></span><br><span class="line">File dir = <span class="keyword">new</span> File(<span class="string">"abc"</span>);</span><br><span class="line"><span class="keyword">boolean</span> b = dir.mkdir();<span class="comment">//make directory		</span></span><br><span class="line">System.out.println(<span class="string">"b="</span>+b);</span><br><span class="line">System.out.println(dir.delete());	<span class="comment">//慎用，不走回收站</span></span><br><span class="line"></span><br><span class="line">File dir = <span class="keyword">new</span> File(<span class="string">"abc\\q\\e\\c\\z\\r\\w\\y\\f\\e\\g\\s"</span>);</span><br><span class="line">dir.mkdirs();<span class="comment">//创建多级目录</span></span><br><span class="line">System.out.println(dir.delete());	<span class="comment">//运行后，仅删除 S 文件夹</span></span><br></pre></td></tr></table></figure>
<ul>
<li>3、判断 </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">File f = <span class="keyword">new</span> File(<span class="string">"aaa"</span>);		</span><br><span class="line"><span class="keyword">boolean</span> b = f.exists();	<span class="comment">//是否存在	</span></span><br><span class="line">System.out.println(<span class="string">"b="</span>+b);</span><br><span class="line"><span class="comment">// 最好先判断是否存在。 </span></span><br><span class="line">System.out.println(f.isFile());		<span class="comment">//是否是文件</span></span><br><span class="line">System.out.println(f.isDirectory());<span class="comment">//是否是目录</span></span><br></pre></td></tr></table></figure>
<ul>
<li>4、重命名</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//可以从C到D盘 重命名</span></span><br><span class="line"><span class="comment">//即为剪切C盘的文件，复制到D盘</span></span><br><span class="line">File f1 = <span class="keyword">new</span> File(<span class="string">"c:\\9.mp3"</span>);</span><br><span class="line">File f2 = <span class="keyword">new</span> File(<span class="string">"d:\\aa.mp3"</span>);</span><br><span class="line"><span class="keyword">boolean</span> b = f1.renameTo(f2);</span><br><span class="line">System.out.println(<span class="string">"b="</span>+b);</span><br></pre></td></tr></table></figure>
<h3 id="根目录方法"><a href="#根目录方法" class="headerlink" title="根目录方法"></a>根目录方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">File[] files  = File.listRoots();</span><br><span class="line"><span class="keyword">for</span>(File file : files)&#123;</span><br><span class="line">	System.out.println(file);</span><br><span class="line">&#125;</span><br><span class="line">File file = <span class="keyword">new</span> File(<span class="string">"d:\\"</span>);</span><br><span class="line">System.out.println(<span class="string">"getFreeSpace:"</span>+file.getFreeSpace());	<span class="comment">//空闲容量</span></span><br><span class="line">System.out.println(<span class="string">"getTotalSpace:"</span>+file.getTotalSpace());	<span class="comment">//总容量</span></span><br><span class="line">System.out.println(<span class="string">"getUsableSpace:"</span>+file.getUsableSpace());<span class="comment">//可使用容量</span></span><br></pre></td></tr></table></figure>
<h3 id="获取目录内容"><a href="#获取目录内容" class="headerlink" title="获取目录内容"></a>获取目录内容</h3><ul>
<li>获取当前目录下的文件以及文件夹的名称，包含隐藏文件</li>
<li>调用list方法的File对象中封装的必须是目录,否则会发生NullPointerException</li>
<li>如果访问的系统级目录也会发生空指针异常。</li>
<li>如果目录存在但是没有内容，会返回一个数组，但是长度为0.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listDemo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    File file = <span class="keyword">new</span> File(<span class="string">"c:\\"</span>);</span><br><span class="line">    String[] names = file.list();</span><br><span class="line">    System.out.println(names.length);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(String name : names)&#123;</span><br><span class="line">    	System.out.println(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h3><ul>
<li>显示后缀.java 的文件，使用 File类的 list方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FilterByJava</span> <span class="keyword">implements</span> <span class="title">FilenameFilter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">accept</span><span class="params">(File dir, String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name.endsWith(<span class="string">".java"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>显示未隐藏的文件，使用 listFiles 方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FilterByHidden</span> <span class="keyword">implements</span> <span class="title">FileFilter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">accept</span><span class="params">(File pathname)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> !pathname.isHidden();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listDemo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">    File dir = <span class="keyword">new</span> File(<span class="string">"c:\\"</span>);</span><br><span class="line"></span><br><span class="line">    File[] files = dir.listFiles(<span class="keyword">new</span> FilterByHidden());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(File file : files)&#123;</span><br><span class="line">        System.out.println(file);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>如果想过滤后缀，但是每次改过滤器太复杂，可以重新设计过滤器</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SuffixFilter</span> <span class="keyword">implements</span> <span class="title">FilenameFilter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String suffix ;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">SuffixFilter</span><span class="params">(String suffix)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.suffix = suffix;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">accept</span><span class="params">(File dir, String name)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> name.endsWith(suffix);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>这样ListDemo 类中就可以更改想要的后缀</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String[] names = dir.list(<span class="keyword">new</span> SuffixFilter(<span class="string">".txt"</span>));</span><br><span class="line">String[] names = dir.list(<span class="keyword">new</span> SuffixFilter(<span class="string">".java"</span>));</span><br></pre></td></tr></table></figure>
<h3 id="练习-2"><a href="#练习-2" class="headerlink" title="练习"></a>练习</h3><h4 id="深度遍历"><a href="#深度遍历" class="headerlink" title="深度遍历"></a>深度遍历</h4><ul>
<li>需求：对指定目录进行所有内容的列出（包含子目录中的内容），也可以理解为 深度遍历。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        File dir = <span class="keyword">new</span> File(<span class="string">"d:\\MyBlog"</span>);</span><br><span class="line"></span><br><span class="line">        listAll(dir,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">listAll</span><span class="params">(File dir, <span class="keyword">int</span> level)</span> </span>&#123;</span><br><span class="line">        System.out.println(getSpace(level)+dir.getAbsolutePath());</span><br><span class="line">        level++;</span><br><span class="line">        File[] file = dir.listFiles();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; file.length; x++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (file[x].isDirectory())</span><br><span class="line">                listAll(file[x], level);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                System.out.println(getSpace(level)+file[x].getAbsoluteFile());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">getSpace</span><span class="params">(<span class="keyword">int</span> level)</span> </span>&#123;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        sb.append(<span class="string">"|-- "</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; level; i++) &#123;</span><br><span class="line">            sb.insert(<span class="number">0</span>, <span class="string">"|  "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="删除目录（含内容的）"><a href="#删除目录（含内容的）" class="headerlink" title="删除目录（含内容的）"></a>删除目录（含内容的）</h4><ul>
<li>删除一个带内容的目录。<ul>
<li>原理：必须从最里面往外，需要进行深度遍历。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Remove</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        File dir = <span class="keyword">new</span> File(<span class="string">"d:\\demodemo"</span>);</span><br><span class="line">        remove(dir);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(File dir)</span></span>&#123;</span><br><span class="line">        File[] files = dir.listFiles();</span><br><span class="line">        <span class="keyword">for</span> (File file:files)&#123;</span><br><span class="line">            <span class="keyword">if</span> (file.isDirectory())</span><br><span class="line">                remove(file);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                System.out.println( file+<span class="string">":"</span>+file.delete());</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println( dir+<span class="string">":"</span>+dir.delete());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Properties"><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><ul>
<li>Properties 是Map 子类Hashtable 的子类</li>
<li>Properties集合特点：<ul>
<li>该集合中的键和值都是字符串类型。</li>
<li>集合中的数据可以保存到流中，或者从流获取。</li>
</ul>
</li>
<li>通常该集合用于操作以键值对形式存在的配置文件。 </li>
</ul>
<h3 id="演示方法"><a href="#演示方法" class="headerlink" title="演示方法"></a>演示方法</h3><ul>
<li>倒数第二行注意，大多数时候用于调试</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">propertiesDemo</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//创建一个Properties集合。</span></span><br><span class="line">	Properties prop  = <span class="keyword">new</span> Properties();</span><br><span class="line"></span><br><span class="line">	<span class="comment">//存储元素。 </span></span><br><span class="line">    prop.setProperty(<span class="string">"zhangsan"</span>,<span class="string">"30"</span>);</span><br><span class="line">	prop.setProperty(<span class="string">"lisi"</span>,<span class="string">"31"</span>);</span><br><span class="line">	prop.setProperty(<span class="string">"wangwu"</span>,<span class="string">"36"</span>);</span><br><span class="line">    prop.setProperty(<span class="string">"zhaoliu"</span>,<span class="string">"20"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//修改元素。 </span></span><br><span class="line">    prop.setProperty(<span class="string">"wangwu"</span>,<span class="string">"26"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//取出所有元素。</span></span><br><span class="line">    Set&lt;String&gt; names = prop.stringPropertyNames();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(String name : names)&#123;</span><br><span class="line">        String value = prop.getProperty(name);</span><br><span class="line">        System.out.println(name+<span class="string">":"</span>+value);</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//多用于调试，在控制台显示所有信息</span></span><br><span class="line">    prop.list(System.out);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>想要将这些集合中的字符串键值信息持久化存储到文件中，则需要关联输出流。（使用store方法）</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">methodDemo_3</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    Properties prop  = <span class="keyword">new</span> Properties();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//存储元素。 </span></span><br><span class="line">    prop.setProperty(<span class="string">"zhangsan"</span>,<span class="string">"30"</span>);</span><br><span class="line">    prop.setProperty(<span class="string">"lisi"</span>,<span class="string">"31"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//关联输出流。</span></span><br><span class="line">    FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"info.txt"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将集合中数据存储到文件中，使用store方法。</span></span><br><span class="line">    prop.store(fos, <span class="string">"info"</span>);</span><br><span class="line"></span><br><span class="line">    fos.close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>既然可以存在文件中，自然可以在文件中读取（使用load方法）</li>
<li>注意：必须要保证该文件中的数据是键值对</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">methodDemo_4</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;	</span><br><span class="line">		</span><br><span class="line">	Properties prop  = <span class="keyword">new</span> Properties();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用到读取流。 </span></span><br><span class="line">    FileInputStream fis = <span class="keyword">new</span> FileInputStream(<span class="string">"info.txt"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用load方法。 </span></span><br><span class="line">    prop.load(fis);</span><br><span class="line"></span><br><span class="line">    prop.list(System.out);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="load方法原理"><a href="#load方法原理" class="headerlink" title="load方法原理"></a>load方法原理</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">myLoad</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">		</span><br><span class="line">    Properties prop  = <span class="keyword">new</span> Properties();</span><br><span class="line"></span><br><span class="line">    BufferedReader bufr = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(<span class="string">"info.txt"</span>));</span><br><span class="line"></span><br><span class="line">    String line = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>((line=bufr.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(line.startsWith(<span class="string">"#"</span>))</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        String[] arr = line.split(<span class="string">"="</span>);</span><br><span class="line"></span><br><span class="line">        prop.setProperty(arr[<span class="number">0</span>], arr[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    prop.list(System.out);</span><br><span class="line"></span><br><span class="line">    bufr.close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="修改配置信息"><a href="#修改配置信息" class="headerlink" title="修改配置信息"></a>修改配置信息</h3><ul>
<li>流程<ul>
<li>读取文件</li>
<li>创建集合存储配置信息</li>
<li>将流信息存储到集合中</li>
<li>修改集合</li>
<li>将集合信息写回文件中</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">(File file)</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">    <span class="comment">//读取这个文件。</span></span><br><span class="line">    <span class="keyword">if</span>(!file.exists())&#123;</span><br><span class="line">    	file.createNewFile();</span><br><span class="line">    &#125;</span><br><span class="line">    FileReader fr = <span class="keyword">new</span> FileReader(file);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建集合存储配置信息。</span></span><br><span class="line">    Properties prop = <span class="keyword">new</span> Properties();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将流中信息存储到集合中。</span></span><br><span class="line">    prop.load(fr);</span><br><span class="line"></span><br><span class="line">    prop.setProperty(<span class="string">"wangwu"</span>, <span class="string">"16"</span>);</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//需要信息修改完后才能将集合与输出流相关联</span></span><br><span class="line">    FileWriter fw = <span class="keyword">new</span> FileWriter(file);</span><br><span class="line"></span><br><span class="line">    prop.store(fw,<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">    fw.close();</span><br><span class="line">    fr.close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="练习一"><a href="#练习一" class="headerlink" title="练习一"></a>练习一</h3><ul>
<li>定义功能：获取一个应用程序运行的次数，</li>
<li>如果超过5次，给出使用次数已到请注册的提示，并不要在运行程序。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">思路：</span><br><span class="line">1、 应该有计数器。 </span><br><span class="line">    每次程序启动都需要计数一次,并且是在原有的次数上进行计数。</span><br><span class="line">2、 计数器就是一个变量。 那么我们就可以，程序启动时候进行计数，计数器必须存在于内存并进行运算。</span><br><span class="line">    可是程序一结束，计数器消失了。那么再次启动该程序，计数器又重新被初始化了。</span><br><span class="line">    而我们需要多次启动同一个应用程序，使用的是同一个计数器。 </span><br><span class="line">    这就需要计数器的生命周期变长，从内存存储到硬盘文件中。</span><br><span class="line"></span><br><span class="line">3、 如何使用这个计数器呢？</span><br><span class="line">    首先，程序启动时，应该先读取这个用于记录计数器信息的配置文件。</span><br><span class="line">    获取上一次计数器次数。 并进行试用次数的判断。</span><br><span class="line">    其次，对该次数进行自增，并自增后的次数重新存储到配置文件中。 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">4、 文件中的信息该如何进行存储并体现。</span><br><span class="line">    直接存储次数值可以，但是不明确该数据的含义。 所以起名字就变得很重要。</span><br><span class="line">    这就有了名字和值的对应，所以可以使用键值对。</span><br><span class="line">    可是映射关系map集合搞定，又需要读取硬盘上的数据，所以map+io = Properties.</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PropertiesTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException  </span>&#123;</span><br><span class="line">		</span><br><span class="line">		getAppCount();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">getAppCount</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//将配置文件封装成File对象。</span></span><br><span class="line">		File confile = <span class="keyword">new</span> File(<span class="string">"count.properties"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(!confile.exists())&#123;</span><br><span class="line">			confile.createNewFile();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		FileInputStream fis = <span class="keyword">new</span> FileInputStream(confile);</span><br><span class="line">		</span><br><span class="line">		Properties prop = <span class="keyword">new</span> Properties();</span><br><span class="line">		</span><br><span class="line">		prop.load(fis);</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//从集合中通过键获取次数。		</span></span><br><span class="line">		String value = prop.getProperty(<span class="string">"time"</span>);</span><br><span class="line">		<span class="comment">//定义计数器。记录获取到的次数。</span></span><br><span class="line">		<span class="keyword">int</span> count =<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(value!=<span class="keyword">null</span>)&#123;</span><br><span class="line">			count = Integer.parseInt(value);</span><br><span class="line">			<span class="keyword">if</span>(count&gt;=<span class="number">5</span>)&#123;</span><br><span class="line">				<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"使用次数已到，请充值vip，给钱！"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		count++;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//将改变后的次数重新存储到集合中。</span></span><br><span class="line">		prop.setProperty(<span class="string">"time"</span>, count+<span class="string">""</span>);</span><br><span class="line">		</span><br><span class="line">		FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(confile);</span><br><span class="line">		</span><br><span class="line">		prop.store(fos, <span class="string">""</span>);</span><br><span class="line">		</span><br><span class="line">		fos.close();</span><br><span class="line">		fis.close();</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="练习二"><a href="#练习二" class="headerlink" title="练习二"></a>练习二</h3><ul>
<li>获取指定目录下，指定扩展名的文件(包含子目录中的)，将这些文件的绝对路径写入到一个文本文件中。</li>
<li>简单说，就是建立一个指定扩展名的文件的列表。 </li>
<li>思路：<ul>
<li>进行深度遍历 </li>
<li>创建过滤器，将符合要求的文件绝对路径写入集合</li>
<li>对容器中内容遍历并将绝对路径写入文件中</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//过滤器</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Filter</span> <span class="keyword">implements</span> <span class="title">FilenameFilter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String suffix;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Filter</span><span class="params">(String suffix)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.suffix = suffix;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">accept</span><span class="params">(File dir, String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name.endsWith(suffix);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        File dir = <span class="keyword">new</span> File(<span class="string">"D:\\Code\\Java"</span>);</span><br><span class="line">        <span class="comment">//过滤".java"结尾的文件</span></span><br><span class="line">        Filter filter = <span class="keyword">new</span> Filter(<span class="string">".java"</span>);</span><br><span class="line">        getFileList(dir,filter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">getFileList</span><span class="params">(File dir, FilenameFilter filter)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//判断目录是否存在，增强健壮性</span></span><br><span class="line">        <span class="keyword">if</span> (!dir.exists())</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException(<span class="string">"该指定目录不存在"</span>);</span><br><span class="line">        <span class="comment">//创建容器</span></span><br><span class="line">        List&lt;File&gt; list = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        getFile(dir,filter,list);</span><br><span class="line">        <span class="comment">//destfile：要存储到的目的文件</span></span><br><span class="line">        File destfile = <span class="keyword">new</span> File(dir,<span class="string">"javaList.txt"</span>);</span><br><span class="line">        writeToFile(list,destfile);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">getFile</span><span class="params">(File dir, FilenameFilter filter, List&lt;File&gt; list)</span> </span>&#123;</span><br><span class="line">        File[] files = dir.listFiles();</span><br><span class="line">        <span class="comment">//深度遍历</span></span><br><span class="line">        <span class="keyword">for</span> (File file:files)&#123;</span><br><span class="line">            <span class="comment">//如果是文件夹，递归</span></span><br><span class="line">            <span class="keyword">if</span> (file.isDirectory())</span><br><span class="line">                getFile(file, filter, list);</span><br><span class="line">            <span class="keyword">else</span><span class="comment">//过滤文件，将其添加到容器中</span></span><br><span class="line">                <span class="keyword">if</span> (filter.accept(file, file.getName())) &#123;</span><br><span class="line">                    list.add(file);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeToFile</span><span class="params">(List&lt;File&gt; list, File destfile)</span> </span>&#123;</span><br><span class="line">        BufferedWriter bw = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            bw = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> FileWriter(destfile));</span><br><span class="line">            <span class="keyword">for</span> (File file:list)&#123;</span><br><span class="line">                bw.write(file.getAbsolutePath());</span><br><span class="line">                bw.newLine();</span><br><span class="line">                bw.flush();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"写入失败"</span>);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (bw != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    bw.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"关闭失败"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="打印流"><a href="#打印流" class="headerlink" title="打印流"></a>打印流</h2><h3 id="PrintStream"><a href="#PrintStream" class="headerlink" title="PrintStream"></a>PrintStream</h3><ul>
<li>1、提供了打印方法可以对多种数据类型值进行打印。并保持数据的表示形式。 </li>
<li>2、它不抛IOException</li>
<li>构造函数，接收三种类型的值：<ul>
<li>1、字符串路径</li>
<li>2、File对象 </li>
<li>3、字节输出流</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">	PrintStream out = <span class="keyword">new</span> PrintStream(<span class="string">"print.txt"</span>);</span><br><span class="line">	<span class="comment">//只写最低8位，对比下面两个结果，文件中存储的值都为 b</span></span><br><span class="line">	out.write(<span class="number">98</span>);</span><br><span class="line">	out.write(<span class="number">610</span>);</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//将97先变成字符保持原样将数据打印到目的地。</span></span><br><span class="line">	out.print(<span class="number">97</span>); </span><br><span class="line">	out.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="PrintWriter"><a href="#PrintWriter" class="headerlink" title="PrintWriter"></a>PrintWriter</h3><ul>
<li>字符打印流</li>
<li>构造函数参数：<ul>
<li>1、字符串路径</li>
<li>2、File对象</li>
<li>3、字节输出流</li>
<li>4、字符输出流</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    BufferedReader bufr = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in));</span><br><span class="line">    <span class="comment">//在创建输出流的时候，最后加上true，则可以自动刷新</span></span><br><span class="line">    PrintWriter out = <span class="keyword">new</span> PrintWriter(<span class="keyword">new</span> FileWriter(<span class="string">"out.txt"</span>),<span class="keyword">true</span>);</span><br><span class="line">	<span class="comment">//PrintWriter out = new PrintWriter(System.out,true);//在控制台输出</span></span><br><span class="line">    String line =  <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">while</span>((line=bufr.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">"over"</span>.equals(line))</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        out.println(line.toUpperCase());</span><br><span class="line">        <span class="comment">//out.flush; 第四行中有了true的设置，就不用手动刷新了</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    out.close();</span><br><span class="line">    bufr.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="序列流"><a href="#序列流" class="headerlink" title="序列流"></a>序列流</h2><ul>
<li>可以将文件合并为一个序列流，对其进行操作</li>
<li><strong>需求</strong>：将1.txt 2.txt 3.txt文件中的数据合并到一个文件中。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SequenceInputStreamDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="comment">//Vector含枚举，但是太慢了</span></span><br><span class="line">		ArrayList&lt;FileInputStream&gt; al = <span class="keyword">new</span> ArrayList&lt;FileInputStream&gt;();</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> x=<span class="number">1</span>; x&lt;=<span class="number">3</span>; x++)&#123;</span><br><span class="line">			al.add(<span class="keyword">new</span> FileInputStream(x+<span class="string">".txt"</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		Enumeration&lt;FileInputStream&gt; en = Collections.enumeration(al);</span><br><span class="line">		<span class="comment">/*	这里是Collection工具类的enumeration实现原理</span></span><br><span class="line"><span class="comment">		  //利用迭代器和新建的枚举</span></span><br><span class="line"><span class="comment">		final Iterator&lt;FileInputStream&gt; it = al.iterator();</span></span><br><span class="line"><span class="comment">		Enumeration&lt;FileInputStream&gt; en = new Enumeration&lt;FileInputStream&gt;()&#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">			@Override</span></span><br><span class="line"><span class="comment">			public boolean hasMoreElements() &#123;</span></span><br><span class="line"><span class="comment">				</span></span><br><span class="line"><span class="comment">				return it.hasNext();</span></span><br><span class="line"><span class="comment">			&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">			@Override</span></span><br><span class="line"><span class="comment">			public FileInputStream nextElement() &#123;</span></span><br><span class="line"><span class="comment">				</span></span><br><span class="line"><span class="comment">				return it.next();</span></span><br><span class="line"><span class="comment">			&#125;</span></span><br><span class="line"><span class="comment">			</span></span><br><span class="line"><span class="comment">		&#125;;*/</span> 	</span><br><span class="line">		</span><br><span class="line">		SequenceInputStream sis = <span class="keyword">new</span> SequenceInputStream(en);</span><br><span class="line">		</span><br><span class="line">		FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="string">"1234.txt"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span>((len=sis.read(buf))!=-<span class="number">1</span>)&#123;</span><br><span class="line">			fos.write(buf,<span class="number">0</span>,len);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		fos.close();</span><br><span class="line">		sis.close();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="文件切割与合并"><a href="#文件切割与合并" class="headerlink" title="文件切割与合并"></a>文件切割与合并</h2><h3 id="切割"><a href="#切割" class="headerlink" title="切割"></a>切割</h3><ul>
<li>需求：将一个.MP3 文件按照 1M 切割</li>
<li>思路：<ul>
<li>用读取流关联源文件，定义缓冲区</li>
<li>创建目的</li>
<li>将被切割文件的信息保存到prop集合中</li>
<li>将prop集合中的数据存储到文件中</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SplitFileDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SIZE = <span class="number">1024</span> * <span class="number">1024</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">		File file = <span class="keyword">new</span> File(<span class="string">"c:\\aa.mp3"</span>);</span><br><span class="line"></span><br><span class="line">		splitFile(file);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">splitFile</span><span class="params">(File file)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 用读取流关联源文件。</span></span><br><span class="line">		FileInputStream fis = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 定义一个1M的缓冲区。</span></span><br><span class="line">		<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[SIZE];</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 创建目的。</span></span><br><span class="line">		FileOutputStream fos = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> count = <span class="number">1</span>;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">		 * 切割文件时，必须记录住被切割文件的名称，以及切割出来碎片文件的个数。 以方便于合并。</span></span><br><span class="line"><span class="comment">		 * 这个信息为了进行描述，使用键值对的方式。用到了properties对象</span></span><br><span class="line"><span class="comment">		 * </span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		Properties prop  = <span class="keyword">new</span> Properties();</span><br><span class="line"></span><br><span class="line">		File dir = <span class="keyword">new</span> File(<span class="string">"c:\\partfiles"</span>);</span><br><span class="line">		<span class="keyword">if</span> (!dir.exists())</span><br><span class="line">			dir.mkdirs();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span> ((len = fis.read(buf)) != -<span class="number">1</span>) &#123;</span><br><span class="line"></span><br><span class="line">			fos = <span class="keyword">new</span> FileOutputStream(<span class="keyword">new</span> File(dir, (count++) + <span class="string">".part"</span>));</span><br><span class="line">			fos.write(buf, <span class="number">0</span>, len);</span><br><span class="line">			fos.close();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//将被切割文件的信息保存到prop集合中。</span></span><br><span class="line">		prop.setProperty(<span class="string">"partcount"</span>, count+<span class="string">""</span>);</span><br><span class="line">		prop.setProperty(<span class="string">"filename"</span>, file.getName());</span><br><span class="line">		</span><br><span class="line">		fos = <span class="keyword">new</span> FileOutputStream(<span class="keyword">new</span> File(dir,count+<span class="string">".properties"</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//将prop集合中的数据存储到文件中。 </span></span><br><span class="line">		prop.store(fos, <span class="string">"save file info"</span>);</span><br><span class="line"></span><br><span class="line">		fos.close();</span><br><span class="line">		fis.close();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="合并"><a href="#合并" class="headerlink" title="合并"></a>合并</h3><ul>
<li>被切割的文件是无法被运行的，需要进行合并（以上面切割代码为示例）</li>
<li>思路：<ul>
<li>获取指定目录下的配置文件对象</li>
<li>记录配置文件对象，获取该配置文件中的信息</li>
<li>获取该目录下的所有碎片文件（.part）</li>
<li>将碎片文件和流对象关联 并存储到集合中</li>
<li>将多个流合并成一个序列流，输出</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MergeFile</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">		File dir = <span class="keyword">new</span> File(<span class="string">"c:\\partfiles"</span>);</span><br><span class="line">		</span><br><span class="line">		mergeFile(dir);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">mergeFile</span><span class="params">(File dir)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">		 * 获取指定目录下的配置文件对象。</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		File[] files = dir.listFiles(<span class="keyword">new</span> SuffixFilter(<span class="string">".properties"</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(files.length!=<span class="number">1</span>)</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(dir+<span class="string">",该目录下没有properties扩展名的文件或者不唯一"</span>);</span><br><span class="line">		<span class="comment">//记录配置文件对象。</span></span><br><span class="line">		File confile = files[<span class="number">0</span>];</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//获取该文件中的信息</span></span><br><span class="line">		Properties prop = <span class="keyword">new</span> Properties();</span><br><span class="line">		FileInputStream fis = <span class="keyword">new</span> FileInputStream(confile);</span><br><span class="line">		</span><br><span class="line">		prop.load(fis);</span><br><span class="line">		</span><br><span class="line">		String filename = prop.getProperty(<span class="string">"filename"</span>);		</span><br><span class="line">		<span class="keyword">int</span> count = Integer.parseInt(prop.getProperty(<span class="string">"partcount"</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//获取该目录下的所有碎片文件。</span></span><br><span class="line">		File[] partFiles = dir.listFiles(<span class="keyword">new</span> SuffixFilter(<span class="string">".part"</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(partFiles.length!=(count-<span class="number">1</span>))&#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">" 碎片文件不符合要求，个数不对!应该"</span>+count+<span class="string">"个"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//将碎片文件和流对象关联 并存储到集合中。 </span></span><br><span class="line">		ArrayList&lt;FileInputStream&gt; al = <span class="keyword">new</span> ArrayList&lt;FileInputStream&gt;();</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> x=<span class="number">0</span>; x&lt;partFiles.length; x++)&#123;</span><br><span class="line">			</span><br><span class="line">			al.add(<span class="keyword">new</span> FileInputStream(partFiles[x]));</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//将多个流合并成一个序列流。 </span></span><br><span class="line">		Enumeration&lt;FileInputStream&gt; en = Collections.enumeration(al);</span><br><span class="line">		SequenceInputStream sis = <span class="keyword">new</span> SequenceInputStream(en);</span><br><span class="line">		</span><br><span class="line">		FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(<span class="keyword">new</span> File(dir,filename));</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>((len=sis.read(buf))!=-<span class="number">1</span>)&#123;</span><br><span class="line">			fos.write(buf,<span class="number">0</span>,len);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		fos.close();</span><br><span class="line">		sis.close();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="操作对象流"><a href="#操作对象流" class="headerlink" title="操作对象流"></a>操作对象流</h2><ul>
<li>平常创建的对象都是存储在硬盘上，通过对象输出流可以将其存储在硬盘中</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Serializable：用于给被序列化的类加入ID号。</span></span><br><span class="line"><span class="comment"> * 用于判断类和对象是否是同一个版本。 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Serializable</span>/*标记接口*/ </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * transient：非静态数据不想被序列化可以使用这个关键字修饰。</span></span><br><span class="line"><span class="comment">	 * 如果不自己添加序列号，序列化后更改name为public 就会报错 </span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">9527l</span>;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">	<span class="comment">//构造函数</span></span><br><span class="line">    <span class="comment">//get set函数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectStreamDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">			</span><br><span class="line">		writeObj();</span><br><span class="line">		readObj();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readObj</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(<span class="string">"obj.object"</span>));</span><br><span class="line">		<span class="comment">//对象的反序列化。 </span></span><br><span class="line">		Person p = (Person)ois.readObject();</span><br><span class="line">		</span><br><span class="line">		System.out.println(p.getName()+<span class="string">":"</span>+p.getAge());</span><br><span class="line">		</span><br><span class="line">		ois.close();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeObj</span><span class="params">()</span> <span class="keyword">throws</span> IOException, IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">"obj.object"</span>));</span><br><span class="line">		<span class="comment">//对象序列化。  被序列化的对象必须实现Serializable接口。 </span></span><br><span class="line">		oos.writeObject(<span class="keyword">new</span> Person(<span class="string">"小强"</span>,<span class="number">30</span>));</span><br><span class="line">		</span><br><span class="line">		oos.close();		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="RandomAccessFile"><a href="#RandomAccessFile" class="headerlink" title="RandomAccessFile"></a>RandomAccessFile</h2><ul>
<li>特点：<ul>
<li>1、即可读取，又可以写入。</li>
<li>2、内部维护了一个大型的byte数组，通过对数组的操作完成读取和写入。</li>
<li>3、通过getFilePointer方法获取指针的位置，还可以通过<strong>seek方法</strong>设置指针的位置。</li>
<li>4、该对象的内容应该封装了字节输入流和字节输出流。</li>
<li>5、该对象只能操作文件。</li>
</ul>
</li>
<li>注意：<ul>
<li>通过seek方法操作指针，可以从这个数组中的任意位置上进行读和写，可以完成对数据的修改。</li>
<li>但是要注意：数据必须有规律。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RandomAccessFileDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;		</span><br><span class="line"><span class="comment">//		writeFile();</span></span><br><span class="line"><span class="comment">//		readFile();</span></span><br><span class="line">		randomWrite();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">randomWrite</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">		RandomAccessFile raf = <span class="keyword">new</span> RandomAccessFile(<span class="string">"ranacc.txt"</span>, <span class="string">"rw"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//往指定位置写入数据。</span></span><br><span class="line">		raf.seek(<span class="number">3</span>*<span class="number">8</span>);</span><br><span class="line">		</span><br><span class="line">		raf.write(<span class="string">"哈哈"</span>.getBytes());</span><br><span class="line">		raf.writeInt(<span class="number">108</span>);</span><br><span class="line">		</span><br><span class="line">		raf.close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readFile</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">		RandomAccessFile raf = <span class="keyword">new</span> RandomAccessFile(<span class="string">"ranacc.txt"</span>, <span class="string">"r"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//通过seek设置指针的位置。</span></span><br><span class="line">		raf.seek(<span class="number">1</span>*<span class="number">8</span>);<span class="comment">//随机的读取。只要指定指针的位置即可。 </span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">4</span>];</span><br><span class="line">		raf.read(buf);</span><br><span class="line">		</span><br><span class="line">		String name = <span class="keyword">new</span> String(buf);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> age = raf.readInt();</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"name="</span>+name);</span><br><span class="line">		System.out.println(<span class="string">"age="</span>+age);</span><br><span class="line">		</span><br><span class="line">		System.out.println(<span class="string">"pos:"</span>+raf.getFilePointer());</span><br><span class="line">		</span><br><span class="line">		raf.close();</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//使用RandomAccessFile对象写入一些人员信息，比如姓名和年龄。</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeFile</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">		<span class="comment">//如果文件不存在，则创建，如果文件存在，不创建</span></span><br><span class="line">		RandomAccessFile raf = <span class="keyword">new</span> RandomAccessFile(<span class="string">"ranacc.txt"</span>,<span class="string">"rw"</span>);</span><br><span class="line">		</span><br><span class="line">		raf.write(<span class="string">"张三"</span>.getBytes());</span><br><span class="line">		raf.writeInt(<span class="number">97</span>);</span><br><span class="line">		raf.write(<span class="string">"小强"</span>.getBytes());</span><br><span class="line">		raf.writeInt(<span class="number">99</span>);</span><br><span class="line">		raf.close();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="管道流"><a href="#管道流" class="headerlink" title="管道流"></a>管道流</h2><ul>
<li>需要和多线程技术相结合的流对象     PipedOutputStream、PipedInputStream </li>
<li>如果想指定哪里来的数据读取哪个数据的话，需要将两个流接上，则使用管道流</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PipedStream</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">		PipedInputStream input = <span class="keyword">new</span> PipedInputStream();</span><br><span class="line">		PipedOutputStream output = <span class="keyword">new</span> PipedOutputStream();</span><br><span class="line">		</span><br><span class="line">		input.connect(output);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">new</span> Thread(<span class="keyword">new</span> Input(input)).start();</span><br><span class="line">		<span class="keyword">new</span> Thread(<span class="keyword">new</span> Output(output)).start();	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Input</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> PipedInputStream in;</span><br><span class="line">	Input(PipedInputStream in)&#123;</span><br><span class="line">		<span class="keyword">this</span>.in = in;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">byte</span>[] buf = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">			<span class="keyword">int</span> len = in.read(buf);</span><br><span class="line">			</span><br><span class="line">			String s = <span class="keyword">new</span> String(buf,<span class="number">0</span>,len);</span><br><span class="line">			</span><br><span class="line">			System.out.println(<span class="string">"s="</span>+s);</span><br><span class="line">			in.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Output</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> PipedOutputStream out;</span><br><span class="line">	Output(PipedOutputStream out)&#123;</span><br><span class="line">		<span class="keyword">this</span>.out = out;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">			out.write(<span class="string">"hi，管道来了！"</span>.getBytes());</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			<span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="操作基本数据类型的流"><a href="#操作基本数据类型的流" class="headerlink" title="操作基本数据类型的流"></a>操作基本数据类型的流</h2><ul>
<li>用操作基本数据类型值的对象  DataInputStream 、DataOutputStream</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSteamDemo</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"><span class="comment">//		writeData();</span></span><br><span class="line">		readData();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readData</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		DataInputStream dis = <span class="keyword">new</span> DataInputStream(<span class="keyword">new</span> FileInputStream(<span class="string">"data.txt"</span>));</span><br><span class="line">		String str = dis.readUTF();</span><br><span class="line">		System.out.println(str);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeData</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		DataOutputStream dos = <span class="keyword">new</span> DataOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">"data.txt"</span>));</span><br><span class="line">		dos.writeUTF(<span class="string">"你好"</span>);</span><br><span class="line">		dos.close();				</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="操作数组的流"><a href="#操作数组的流" class="headerlink" title="操作数组的流"></a>操作数组的流</h2><ul>
<li>设备是内存的流对象。</li>
<li>ByteArrayInputStream ByteArrayOutputStream</li>
<li>CharArrayReader  CharArrayWriter</li>
<li>StringReader StringWriter</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ByteArrayStreamDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		ByteArrayInputStream bis = <span class="keyword">new</span> ByteArrayInputStream(<span class="string">"abcedf"</span>.getBytes());</span><br><span class="line">		ByteArrayOutputStream bos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">int</span> ch = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>((ch=bis.read())!=-<span class="number">1</span>)&#123;</span><br><span class="line">			bos.write(ch);</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(bos.toString());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="编码表"><a href="#编码表" class="headerlink" title="编码表"></a>编码表</h2><h3 id="常见编码表"><a href="#常见编码表" class="headerlink" title="常见编码表"></a>常见编码表</h3><ul>
<li>ASCII：<ul>
<li>美国标准信息交换码，用一个字节7位表示</li>
</ul>
</li>
<li>ISO8859-1：<ul>
<li>拉丁码表，用一个字节8位表示</li>
</ul>
</li>
<li>GB2312：<ul>
<li>中文编码表</li>
</ul>
</li>
<li>GBK：<ul>
<li>升级的中文编码表</li>
</ul>
</li>
<li>Unicode：<ul>
<li>国际标准码，融合多种文字（均用两字节表示）</li>
</ul>
</li>
<li>UTF-8：<ul>
<li>国标码（最多三个字节表示一个字符）</li>
</ul>
</li>
</ul>
<h3 id="简单编码解码"><a href="#简单编码解码" class="headerlink" title="简单编码解码"></a>简单编码解码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">encodeDemo</span><span class="params">(String str)</span></span></span><br><span class="line"><span class="function">    			<span class="keyword">throws</span> UnsupportedEncodingException </span>&#123;</span><br><span class="line">    <span class="comment">//编码</span></span><br><span class="line">    <span class="keyword">byte</span>[] buf = str.getBytes(<span class="string">"UTF-8"</span>);</span><br><span class="line"></span><br><span class="line">    printBytes(buf);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//解码</span></span><br><span class="line">    String s1 = <span class="keyword">new</span> String(buf,<span class="string">"UTF-8"</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"s1="</span>+s1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printBytes</span><span class="params">(<span class="keyword">byte</span>[] buf)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">byte</span> b : buf)&#123;</span><br><span class="line">        System.out.print(b +<span class="string">" "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="问题1"><a href="#问题1" class="headerlink" title="问题1"></a>问题1</h4><ul>
<li>如果编码的时候是 ” GBK“， 解码的时候是 ”iso8859-1“ 怎么解决</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> UnsupportedEncodingException </span>&#123;</span><br><span class="line">        String str = <span class="string">"谢谢"</span>;</span><br><span class="line">        encodeDemo(str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">encodeDemo</span><span class="params">(String str)</span> <span class="keyword">throws</span> UnsupportedEncodingException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">byte</span>[] buf = str.getBytes(<span class="string">"gbk"</span>);</span><br><span class="line">        String s1 = <span class="keyword">new</span> String(buf,<span class="string">"iso8859-1"</span>);</span><br><span class="line">        System.out.println(<span class="string">"s1="</span>+s1);</span><br><span class="line">    	<span class="comment">//用iso8859-1编码</span></span><br><span class="line">        <span class="keyword">byte</span>[] buf2 = s1.getBytes(<span class="string">"iso8859-1"</span>);</span><br><span class="line">    	<span class="comment">//用GBK解码</span></span><br><span class="line">        String s2 = <span class="keyword">new</span> String(buf2,<span class="string">"GBK"</span>);</span><br><span class="line">        System.out.println(<span class="string">"s2="</span>+s2);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>如果编码用GBK，解码用UTF-8，会出现什么问题</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> UnsupportedEncodingException </span>&#123;</span><br><span class="line">        String str1 = <span class="string">"你好"</span>;</span><br><span class="line">        String str2 = <span class="string">"哈哈"</span>;</span><br><span class="line">        String str3 = <span class="string">"谢谢"</span>;</span><br><span class="line">        encodeDemo(str1);</span><br><span class="line">        encodeDemo(str2);</span><br><span class="line">        encodeDemo(str3);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">encodeDemo</span><span class="params">(String str)</span> <span class="keyword">throws</span> UnsupportedEncodingException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">byte</span>[] buf = str.getBytes(<span class="string">"gbk"</span>);</span><br><span class="line">        String s1 = <span class="keyword">new</span> String(buf,<span class="string">"utf-8"</span>);</span><br><span class="line">        System.out.println(<span class="string">"s1="</span>+s1);</span><br><span class="line">    	<span class="comment">//用iso8859-1编码</span></span><br><span class="line">        <span class="keyword">byte</span>[] buf2 = s1.getBytes(<span class="string">"utf-8"</span>);</span><br><span class="line">    	<span class="comment">//用GBK解码</span></span><br><span class="line">        String s2 = <span class="keyword">new</span> String(buf2,<span class="string">"GBK"</span>);</span><br><span class="line">        System.out.println(<span class="string">"s2="</span>+s2);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>运行一下上面的代码 看看结果是什么样的？<ul>
<li>只有谢谢成功转回原样，其他的都是类似这样的–&gt;”锟斤拷锟�“</li>
</ul>
</li>
<li>我们把printBytes的注释 <strong>解掉</strong>，发现 ”-17 -65 -67“ ，重复出现，这是什么原因呢？<ul>
<li>因为”你好“的字节在经过 UTF-8 转义时出现了错误 ，没有能够成功识别，</li>
<li>返回的不是“你好”的字节，而是UTF-8特有的 未知字符 的字节</li>
</ul>
</li>
</ul>
<h3 id="联通问题"><a href="#联通问题" class="headerlink" title="联通问题"></a>联通问题</h3><ul>
<li>切换到桌面，新建一个文本文档，在里面输入”联通“ 这两个字，保存后关闭，重新打开，发现什么问题？</li>
<li>是否发现不是联通两个字，变成了未知字符那？</li>
</ul>
<p><img src="https://raw.githubusercontent.com/OrangeTop/BlogImage/master/oldImage/TIM%E5%9B%BE%E7%89%8720180525165910.png" alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> UnsupportedEncodingException </span>&#123;</span><br><span class="line">        String str = <span class="string">"联通"</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] buf = str.getBytes(<span class="string">"gbk"</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">byte</span> b : buf)&#123;</span><br><span class="line">            System.out.print(b+<span class="string">" "</span>);</span><br><span class="line">            <span class="comment">//System.out.println(Integer.toBinaryString(b));</span></span><br><span class="line">            System.out.println(Integer.toBinaryString(b&amp;<span class="number">255</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>我们试试用GBK解码”联通“，先看一下他的字节，没有发现什么，再转为二进制取后八位</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">11000001</span><br><span class="line">10101010</span><br><span class="line">11001101</span><br><span class="line">10101000</span><br></pre></td></tr></table></figure>
<ul>
<li>开头分别是110，10 这就导致它被记事本解码时，误以为是UTF-8，于是解码后出现未知字符</li>
</ul>
<h3 id="练习-3"><a href="#练习-3" class="headerlink" title="练习"></a>练习</h3><ul>
<li>在java中，字符串“abcd”与字符串“ab你好”的长度是一样，都是四个字符。</li>
<li>但对应的字节数不同，一个汉字占两个字节。</li>
<li><strong>定义一个方法，按照最大的字节数来取子串</strong><ul>
<li>如：对于“ab你好”，如果取三个字节，那么子串就是ab与“你”字的半个，</li>
<li>那么半个就要舍弃。如果去四个字节就是“ab你”，取五个字节还是“ab你”.</li>
</ul>
</li>
<li>思路：<ul>
<li>我们先从GBK编码的入手，字母是一个字节，汉字是两个字节</li>
<li>汉字两个字节开头都是1，所以为负数，如“你”字，-60 -29</li>
<li>以”ab你好“为例，97 98 -60 -29 -70 -61 一次取5字节，进行判断</li>
<li>指针指向-70，为负数，指针前移，若指向负数，计数器每次加一，直到指针指向正数</li>
<li>如果计数器值%2为0，可以全部输出</li>
<li>如果%2为1，输出（截取字节数-1）个字节（取5字节就是这种情况）</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">    String str = <span class="string">"ab你好cd谢谢"</span>;</span><br><span class="line">    <span class="keyword">int</span> len = str.getBytes(<span class="string">"GBK"</span>).length;		</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> x=<span class="number">0</span>; x&lt;len; x++)&#123;</span><br><span class="line">        System.out.println(<span class="string">"截取"</span>+(x+<span class="number">1</span>)+<span class="string">"个字节结果是："</span>+cutStringByByte(str, x+<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">cutStringByByte</span><span class="params">(String str,<span class="keyword">int</span> len)</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">		</span><br><span class="line">    <span class="keyword">byte</span>[] buf = str.getBytes(<span class="string">"gbk"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> x=len-<span class="number">1</span>; x&gt;=<span class="number">0</span>; x--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(buf[x]&lt;<span class="number">0</span>)</span><br><span class="line">            count++;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(count%<span class="number">2</span>==<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(buf,<span class="number">0</span>,len,<span class="string">"gbk"</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String(buf,<span class="number">0</span>,len-<span class="number">1</span>,<span class="string">"gbk"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>UTF-8</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">cutStringByU8Byte</span><span class="params">(String str, <span class="keyword">int</span> len)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		</span><br><span class="line">        <span class="keyword">byte</span>[] buf = str.getBytes(<span class="string">"utf-8"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> x=len-<span class="number">1</span>; x&gt;=<span class="number">0</span>; x--)&#123;</span><br><span class="line">            <span class="keyword">if</span>(buf[x]&lt;<span class="number">0</span>)</span><br><span class="line">                count++;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(count%<span class="number">3</span>==<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> String(buf,<span class="number">0</span>,len,<span class="string">"utf-8"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(count%<span class="number">3</span>==<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> String(buf,<span class="number">0</span>,len-<span class="number">1</span>,<span class="string">"utf-8"</span>);</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> String(buf,<span class="number">0</span>,len-<span class="number">2</span>,<span class="string">"utf-8"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Java/" rel="tag"><i class="fa fa-tag"></i> Java</a>
          
            <a href="/tags/JavaSE/" rel="tag"><i class="fa fa-tag"></i> JavaSE</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/05/15/Java-其余对象API/" rel="next" title="Java-其余对象API">
                <i class="fa fa-chevron-left"></i> Java-其余对象API
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/05/26/Java-GUI/" rel="prev" title="Java-GUI">
                Java-GUI <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Orange</p>
              <p class="site-description motion-element" itemprop="description">welcome everyone to my blog!</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">62</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">23</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#字符流"><span class="nav-number">1.</span> <span class="nav-text">字符流</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#FileWriter"><span class="nav-number">1.1.</span> <span class="nav-text">FileWriter</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#使用方法"><span class="nav-number">1.1.1.</span> <span class="nav-text">使用方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#处理异常"><span class="nav-number">1.1.2.</span> <span class="nav-text">处理异常</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FileReader"><span class="nav-number">1.2.</span> <span class="nav-text">FileReader</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#练习：复制文件"><span class="nav-number">1.2.1.</span> <span class="nav-text">练习：复制文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#缓冲区"><span class="nav-number">1.3.</span> <span class="nav-text">缓冲区</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#BufferWriter"><span class="nav-number">1.3.1.</span> <span class="nav-text">BufferWriter</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BufferReader"><span class="nav-number">1.3.2.</span> <span class="nav-text">BufferReader</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#自定义MyBufferReader"><span class="nav-number">1.3.3.</span> <span class="nav-text">自定义MyBufferReader</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#装饰设计模式"><span class="nav-number">1.3.4.</span> <span class="nav-text">装饰设计模式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#装饰和继承对比"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">装饰和继承对比</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LineNumberReader"><span class="nav-number">1.3.5.</span> <span class="nav-text">LineNumberReader</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#字节流"><span class="nav-number">2.</span> <span class="nav-text">字节流</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#练习"><span class="nav-number">2.1.</span> <span class="nav-text">练习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#键盘录入"><span class="nav-number">2.2.</span> <span class="nav-text">键盘录入</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#练习-1"><span class="nav-number">2.2.1.</span> <span class="nav-text">练习</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#转换流"><span class="nav-number">3.</span> <span class="nav-text">转换流</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#编码解码"><span class="nav-number">3.1.</span> <span class="nav-text">编码解码</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#流的操作规律"><span class="nav-number">4.</span> <span class="nav-text">流的操作规律</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#File对象"><span class="nav-number">5.</span> <span class="nav-text">File对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#方法"><span class="nav-number">5.1.</span> <span class="nav-text">方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#根目录方法"><span class="nav-number">5.2.</span> <span class="nav-text">根目录方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#获取目录内容"><span class="nav-number">5.3.</span> <span class="nav-text">获取目录内容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#过滤器"><span class="nav-number">5.4.</span> <span class="nav-text">过滤器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#练习-2"><span class="nav-number">5.5.</span> <span class="nav-text">练习</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#深度遍历"><span class="nav-number">5.5.1.</span> <span class="nav-text">深度遍历</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#删除目录（含内容的）"><span class="nav-number">5.5.2.</span> <span class="nav-text">删除目录（含内容的）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Properties"><span class="nav-number">6.</span> <span class="nav-text">Properties</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概述"><span class="nav-number">6.1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#演示方法"><span class="nav-number">6.2.</span> <span class="nav-text">演示方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#load方法原理"><span class="nav-number">6.3.</span> <span class="nav-text">load方法原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修改配置信息"><span class="nav-number">6.4.</span> <span class="nav-text">修改配置信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#练习一"><span class="nav-number">6.5.</span> <span class="nav-text">练习一</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#练习二"><span class="nav-number">6.6.</span> <span class="nav-text">练习二</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#打印流"><span class="nav-number">7.</span> <span class="nav-text">打印流</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#PrintStream"><span class="nav-number">7.1.</span> <span class="nav-text">PrintStream</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PrintWriter"><span class="nav-number">7.2.</span> <span class="nav-text">PrintWriter</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#序列流"><span class="nav-number">8.</span> <span class="nav-text">序列流</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文件切割与合并"><span class="nav-number">9.</span> <span class="nav-text">文件切割与合并</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#切割"><span class="nav-number">9.1.</span> <span class="nav-text">切割</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#合并"><span class="nav-number">9.2.</span> <span class="nav-text">合并</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#操作对象流"><span class="nav-number">10.</span> <span class="nav-text">操作对象流</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RandomAccessFile"><span class="nav-number">11.</span> <span class="nav-text">RandomAccessFile</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#管道流"><span class="nav-number">12.</span> <span class="nav-text">管道流</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#操作基本数据类型的流"><span class="nav-number">13.</span> <span class="nav-text">操作基本数据类型的流</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#操作数组的流"><span class="nav-number">14.</span> <span class="nav-text">操作数组的流</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#编码表"><span class="nav-number">15.</span> <span class="nav-text">编码表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#常见编码表"><span class="nav-number">15.1.</span> <span class="nav-text">常见编码表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#简单编码解码"><span class="nav-number">15.2.</span> <span class="nav-text">简单编码解码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#问题1"><span class="nav-number">15.2.1.</span> <span class="nav-text">问题1</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#联通问题"><span class="nav-number">15.3.</span> <span class="nav-text">联通问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#练习-3"><span class="nav-number">15.4.</span> <span class="nav-text">练习</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Orange</span>

  
</div>
<!--

  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>

-->


<!--
<span id="busuanzi_container_site_pv">
    本站总访问量<span id="busuanzi_value_site_pv"></span>次  |
</span>
<span id="busuanzi_container_site_uv">
  本站访客数<i class="fas fa-user-alt"></i><span id="busuanzi_value_site_uv"></span>人次
</span>
-->


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("LuHGRLaVuohiDBVc9oUVcCtW-gzGzoHsz", "x62miE9CqsHHdw9OWtAryAns");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  



</body>
</html>
